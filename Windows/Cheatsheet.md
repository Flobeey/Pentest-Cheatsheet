
# Windows

### Searching windows logs
```powershell
get-eventlog -logname security -instanceid
```

### Searching through services
```powershell
get-service | ?{$_.Statis -eq "Running"} | where-object {$_.Name -like "*update*"}
get-service | ?{$_.Statis -eq "Running"} | ?{$_.Name -like "*update*"}
```
### Local Things
```powershell
get-localusers
get-localusers -name bob | select * 
get-localgroup
get-localgroup -name HR | select * 
```
### Listing files
```
tree /F
```
### Deleting
```
del 
erase file-3 file-5
```

### Forensic tools
https://www.hackthebox.com/blog/anti-forensics-techniques
`**Sdelete64.exe /p 5 “c:\users\CyberJunkie\Desktop\HTB Blog\HTB IS AWESOME.txt”**`
USN Journal

#### Recursive Where

Recursive Where

```powershell
C:\Users\student\Desktop>where /R C:\Users\student\ bio.txt

C:\Users\student\Downloads\bio.txt

C:\Users\student\Desktop>where /R C:\Users\student\ *.csv
```
Find
```powershell
C:\Users\student\Desktop> find "password" 'C:\Users\student\not-passwords.txt' 

C:\Users\student\Desktop> find /N /I /V "IP Address" example.txt  
```
/V - for not match
/N - display line numbers
/I - ignore case sensitive

#### Finding Files
```powershell
find /i "see" < test.txt
ipconfig /all | find /i "IPV4"
```

#### Findstr similar to grep
```powershell
findstr
```

#### Compare files
```powershell
C:\Users\student\Desktop> comp .\file-1.md .\file-2.md
# /A - differences in ASCII format
# /L - line numbers
```


#### Running cmd from powershell
```powershell
cmd /c command
```

[[9. Working With Scheduled Tasks]]

I#### nstalling RSAT
```powershell
Get-WindowsCapability -Name RSAT* -Online | Add-WindowsCapability -Online
```


#### Searching On An Attribute
```powershell
Get-ADUser -Filter {EmailAddress -like '*greenhorn.corp'}
```


#### Listing network connections
```powershell
# Used to view shares available on a host
net view \\PCNAME

# List the PCs currently communitcating with outbound
net use

# List the PCs currently communicating with inbound
net session

# Lists all TCP and UDP connections
netstat -naob
```

#### Getting information on process
```powershell
wmic process where processid=1111 get commandline

# List processes with parents and process id
wmic process get name,parentprocessid,processid | find "<PID>"

# List services associated with executables
tasklist /svc

# Show the dlls associated with executables
tasklist /m
tasklist /m dllnamme.dll

# Shows dlls with specific process id
tasklist /m /di "pid eq 1111"
```

#### Sorting recently modified
```powershell
get-childitem -file -recurse | Sort-Object LastWriteTime | select-object -first 10
```
